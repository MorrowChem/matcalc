

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>matcalc._qha module &mdash; matcalc 0.4.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="assets/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="assets/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="assets/css/custom.css" />


    <link rel="canonical" href="http://matcalc.aimatcalc._qha.html"/>
      <script src="assets/jquery.js?v=5d32c60e"></script>
      <script src="assets/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="assets/documentation_options.js?v=ff822928"></script>
      <script src="assets/doctools.js?v=9bcbadda"></script>
      <script src="assets/sphinx_highlight.js?v=dc90522c"></script>
    <script src="assets/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="matcalc._relaxation module" href="matcalc._relaxation.html" />
    <link rel="prev" title="matcalc._phonon3 module" href="matcalc._phonon3.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: linear-gradient(0deg, rgba(23,63,162,1) 0%, rgba(0,70,192,1) 100%)" >



          <a href="index.html">

          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="matcalc.html">matcalc package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="matcalc.html#subpackages">Subpackages</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="matcalc.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="matcalc._base.html">matcalc._base module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._cli.html">matcalc._cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._elasticity.html">matcalc._elasticity module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._eos.html">matcalc._eos module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._lammps.html">matcalc._lammps module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._md.html">matcalc._md module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._neb.html">matcalc._neb module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._phonon.html">matcalc._phonon module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._phonon3.html">matcalc._phonon3 module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">matcalc._qha module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#matcalc._qha.QHACalc"><code class="docutils literal notranslate"><span class="pre">QHACalc</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._relaxation.html">matcalc._relaxation module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._stability.html">matcalc._stability module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc._surface.html">matcalc._surface module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc.benchmark.html">matcalc.benchmark module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc.config.html">matcalc.config module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc.units.html">matcalc.units module</a></li>
<li class="toctree-l3"><a class="reference internal" href="matcalc.utils.html">matcalc.utils module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: linear-gradient(0deg, rgba(23,63,162,1) 0%, rgba(0,70,192,1) 100%)" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">matcalc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="matcalc.html">matcalc package</a></li>
      <li class="breadcrumb-item active">matcalc._qha module</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/materialsvirtuallab/matcalc/blob/master/docs_rst/matcalc._qha.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="module-matcalc._qha">
<span id="matcalc-qha-module"></span><h1>matcalc._qha module<a class="headerlink" href="#module-matcalc._qha" title="Link to this heading">ÔÉÅ</a></h1>
<p>Calculator for phonon properties under quasi-harmonic approximation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">QHACalc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calculator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Calculator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'FIRE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vinet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relax_structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relax_calc_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phonon_calc_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.95,</span> <span class="pre">0.96,</span> <span class="pre">0.97,</span> <span class="pre">0.98,</span> <span class="pre">0.99,</span> <span class="pre">1.0,</span> <span class="pre">1.01,</span> <span class="pre">1.02,</span> <span class="pre">1.03,</span> <span class="pre">1.04,</span> <span class="pre">1.05)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_helmholtz_volume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_volume_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_thermal_expansion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_gibbs_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_bulk_modulus_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_heat_capacity_p_numerical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_heat_capacity_p_polyfit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_gruneisen_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L25-L389"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <a class="reference internal" href="matcalc._base.html#matcalc._base.PropCalc" title="matcalc._base.PropCalc"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropCalc</span></code></a></p>
<p>Class for performing quasi-harmonic approximation calculations.</p>
<p>This class utilizes phonopy and Pymatgen-based structure manipulation to calculate
thermal properties such as Gibbs free energy, thermal expansion, heat capacity, and
bulk modulus as a function of temperature under the quasi-harmonic approximation.
It allows for structural relaxation, handling customized scale factors for lattice constants,
and fine-tuning various calculation parameters. Calculation results can be selectively
saved to output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calculator</strong> ‚Äì Calculator instance used for electronic structure or energy calculations.</p></li>
<li><p><strong>t_step</strong> ‚Äì Temperature step size in Kelvin.</p></li>
<li><p><strong>t_max</strong> ‚Äì Maximum temperature in Kelvin.</p></li>
<li><p><strong>t_min</strong> ‚Äì Minimum temperature in Kelvin.</p></li>
<li><p><strong>fmax</strong> ‚Äì Maximum force threshold for structure relaxation in eV/√Ö.</p></li>
<li><p><strong>optimizer</strong> ‚Äì Type of optimizer used for structural relaxation.</p></li>
<li><p><strong>eos</strong> ‚Äì Equation of state used for fitting energy vs. volume data.</p></li>
<li><p><strong>relax_structure</strong> ‚Äì Whether to perform structure relaxation before phonon calculations.</p></li>
<li><p><strong>relax_calc_kwargs</strong> ‚Äì Additional keyword arguments for structure relaxation calculations.</p></li>
<li><p><strong>phonon_calc_kwargs</strong> ‚Äì Additional keyword arguments for phonon calculations.</p></li>
<li><p><strong>scale_factors</strong> ‚Äì List of scale factors for lattice scaling.</p></li>
<li><p><strong>write_helmholtz_volume</strong> ‚Äì Path or boolean to control saving Helmholtz free energy vs. volume data.</p></li>
<li><p><strong>write_volume_temperature</strong> ‚Äì Path or boolean to control saving volume vs. temperature data.</p></li>
<li><p><strong>write_thermal_expansion</strong> ‚Äì Path or boolean to control saving thermal expansion coefficient data.</p></li>
<li><p><strong>write_gibbs_temperature</strong> ‚Äì Path or boolean to control saving Gibbs free energy as a function of temperature.</p></li>
<li><p><strong>write_bulk_modulus_temperature</strong> ‚Äì Path or boolean to control saving bulk modulus vs. temperature data.</p></li>
<li><p><strong>write_heat_capacity_p_numerical</strong> ‚Äì Path or boolean to control saving numerically calculated heat capacity vs.
temperature data.</p></li>
<li><p><strong>write_heat_capacity_p_polyfit</strong> ‚Äì Path or boolean to control saving polynomial-fitted heat capacity vs.
temperature data.</p></li>
<li><p><strong>write_gruneisen_temperature</strong> ‚Äì Path or boolean to control saving Gr√ºneisen parameter vs. temperature data.</p></li>
</ul>
</dd>
</dl>
<p>Initializes the class that handles thermal and structural calculations, including atomic
structure relaxation, property evaluations, and phononic calculations across temperature
ranges. This class is mainly designed to facilitate systematic computations involving
temperature-dependent material properties and thermodynamic quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calculator</strong> ‚Äì Calculator object or string indicating the computational engine to use
for performing calculations.</p></li>
<li><p><strong>t_step</strong> ‚Äì Step size for the temperature range, given in units of temperature.</p></li>
<li><p><strong>t_max</strong> ‚Äì Maximum temperature for the calculations, given in units of temperature.</p></li>
<li><p><strong>t_min</strong> ‚Äì Minimum temperature for the calculations, given in units of temperature.</p></li>
<li><p><strong>fmax</strong> ‚Äì Maximum force convergence criterion for structure relaxation, in force units.</p></li>
<li><p><strong>optimizer</strong> ‚Äì Name of the optimizer to use for structure optimization, default is
‚ÄúFIRE‚Äù.</p></li>
<li><p><strong>eos</strong> ‚Äì Equation of state to use for calculating energy vs. volume relationships.
Default is ‚Äúvinet‚Äù.</p></li>
<li><p><strong>relax_structure</strong> ‚Äì A boolean flag indicating whether the atomic structure should be
relaxed as part of the computation workflow.</p></li>
<li><p><strong>relax_calc_kwargs</strong> ‚Äì A dictionary containing additional keyword arguments to pass to
the relax calculation.</p></li>
<li><p><strong>phonon_calc_kwargs</strong> ‚Äì A dictionary containing additional parameters to pass to the
phonon calculation routine.</p></li>
<li><p><strong>scale_factors</strong> ‚Äì A sequence of scale factors for volume scaling during
thermodynamic and phononic calculations.</p></li>
<li><p><strong>write_helmholtz_volume</strong> ‚Äì Path, boolean, or string to indicate whether and where
to save Helmholtz energy as a function of volume.</p></li>
<li><p><strong>write_volume_temperature</strong> ‚Äì Path, boolean, or string to indicate whether and where
to save equilibrium volume as a function of temperature.</p></li>
<li><p><strong>write_thermal_expansion</strong> ‚Äì Path, boolean, or string to indicate whether and where
to save the thermal expansion coefficient as a function of temperature.</p></li>
<li><p><strong>write_gibbs_temperature</strong> ‚Äì Path, boolean, or string to indicate whether and where
to save Gibbs energy as a function of temperature.</p></li>
<li><p><strong>write_bulk_modulus_temperature</strong> ‚Äì Path, boolean, or string to indicate whether and
where to save bulk modulus as a function of temperature.</p></li>
<li><p><strong>write_heat_capacity_p_numerical</strong> ‚Äì Path, boolean, or string to indicate whether and
where to save specific heat capacity at constant pressure, calculated numerically.</p></li>
<li><p><strong>write_heat_capacity_p_polyfit</strong> ‚Äì Path, boolean, or string to indicate whether and
where to save specific heat capacity at constant pressure, calculated via polynomial
fitting.</p></li>
<li><p><strong>write_gruneisen_temperature</strong> ‚Äì Path, boolean, or string to indicate whether and
where to save Gr√ºneisen parameter values as a function of temperature.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/matcalc/_qha.py"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc._abc_impl" title="Link to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc._calculate_thermal_properties">
<span class="sig-name descname"><span class="pre">_calculate_thermal_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Structure</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L288-L306"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc._calculate_thermal_properties" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Helper to calculate the thermal properties of a structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> ‚Äì Pymatgen structure for which the thermal properties are calculated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of thermal properties containing free energies, entropies and heat capacities.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc._collect_properties">
<span class="sig-name descname"><span class="pre">_collect_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Structure</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L249-L272"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc._collect_properties" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Helper to collect properties like volumes, electronic energies, and thermal properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> ‚Äì Pymatgen structure for which the properties need to be calculated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing lists of volumes, electronic energies, free energies, entropies,</dt><dd><p>and heat capacities for different scale factors.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc._create_qha">
<span class="sig-name descname"><span class="pre">_create_qha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volumes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electronic_energies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperatures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">free_energies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heat_capacities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PhonopyQHA</span></span></span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L308-L339"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc._create_qha" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Helper to create a PhonopyQHA object for quasi-harmonic approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volumes</strong> ‚Äì List of volumes corresponding to different scale factors.</p></li>
<li><p><strong>electronic_energies</strong> ‚Äì List of electronic energies corresponding to different volumes.</p></li>
<li><p><strong>temperatures</strong> ‚Äì List of temperatures in ascending order (in Kelvin).</p></li>
<li><p><strong>free_energies</strong> ‚Äì List of free energies corresponding to different volumes and temperatures.</p></li>
<li><p><strong>entropies</strong> ‚Äì List of entropies corresponding to different volumes and temperatures.</p></li>
<li><p><strong>heat_capacities</strong> ‚Äì List of heat capacities corresponding to different volumes and temperatures.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Phonopy.qha object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc._generate_output_dict">
<span class="sig-name descname"><span class="pre">_generate_output_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PhonopyQHA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volumes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electronic_energies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperatures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L364-L389"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc._generate_output_dict" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Helper to generate the output dictionary after QHA calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qha</strong> ‚Äì Phonopy.qha object.</p></li>
<li><p><strong>volumes</strong> ‚Äì List of volumes corresponding to different scale factors.</p></li>
<li><p><strong>electronic_energies</strong> ‚Äì List of electronic energies corresponding to different volumes.</p></li>
<li><p><strong>temperatures</strong> ‚Äì List of temperatures in ascending order (in Kelvin).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the results of QHA calculation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc._scale_structure">
<span class="sig-name descname"><span class="pre">_scale_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Structure</span></span></span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L274-L286"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc._scale_structure" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Helper to scale the lattice of a structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> ‚Äì Pymatgen structure to be scaled.</p></li>
<li><p><strong>scale_factor</strong> ‚Äì Factor by which the lattice constants are scaled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pymatgen structure with scaled lattice constants.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc._write_output_files">
<span class="sig-name descname"><span class="pre">_write_output_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PhonopyQHA</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L341-L362"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc._write_output_files" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Helper to write various output files based on the QHA calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qha</strong> ‚Äì Phonopy.qha object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matcalc._qha.QHACalc.calc">
<span class="sig-name descname"><span class="pre">calc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Structure</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Atoms</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference external" href="https://github.com/materialsvirtuallab/matcalc/blob/v0.4.2/src/matcalc/_qha.py#L206-L247"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#matcalc._qha.QHACalc.calc" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Calculates thermal properties of Pymatgen structure with phonopy under quasi-harmonic approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> ‚Äì Pymatgen structure.</p>
</dd>
</dl>
<p>Returns:
{</p>
<blockquote>
<div><p>‚Äúqha‚Äù: Phonopy.qha object,
‚Äúscale_factors‚Äù: List of scale factors of lattice constants,
‚Äúvolumes‚Äù: List of unit cell volumes at corresponding scale factors (in Angstrom^3),
‚Äúelectronic_energies‚Äù: List of electronic energies at corresponding volumes (in eV),
‚Äútemperatures‚Äù: List of temperatures in ascending order (in Kelvin),
‚Äúthermal_expansion_coefficients‚Äù: List of volumetric thermal expansion coefficients at corresponding</p>
<blockquote>
<div><p>temperatures (in Kelvin^-1),</p>
</div></blockquote>
<p>‚Äúgibbs_free_energies‚Äù: List of Gibbs free energies at corresponding temperatures (in eV),
‚Äúbulk_modulus_P‚Äù: List of bulk modulus at constant pressure at corresponding temperatures (in GPa),
‚Äúheat_capacity_P‚Äù: List of heat capacities at constant pressure at corresponding temperatures (in J/K/mol),
‚Äúgruneisen_parameters‚Äù: List of Gruneisen parameters at corresponding temperatures,</p>
</div></blockquote>
<p>}</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Materials Virtual Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
